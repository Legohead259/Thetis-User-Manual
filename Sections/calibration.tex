\section{Calibration}
\label{sec:calibration}

Each device is calibrated during production to achieve the specified accuracy.  The calibration process uses specialist equipment and propriety algorithms to calculate calibration parameters specific to each device.  These parameters are used by the calibration models described in the following sections to compensate for the characteristics of each measurement source.  Calibration is performed at room temperature and accuracy will be reduced for operating temperatures that deviate from this temperature.  Please refer to the calibration certificate for specific temperature values.

\subsection{System clock and \acs{RTC}}
\label{sec:systemClockAndRtc}

The system clock and \ac{RTC} are calibrated for errors in each clock source.  The clock calibration model is described by \Fref{eq:clock} where $f_c$ is the calibrated clock frequency obtained from the uncalibrated clock frequency, $f_u$, given the value, $c$.  The units of $f_c$ and $f_u$ are Hz.  $c$ is a ratio and therefore has no units.  The calibration parameter $c$ for each clock can be accessed as device settings.

\begin{equation}
\label{eq:clock}
f_c = c f_u
\end{equation}

\subsection{Battery voltmeter}
\label{sec:batteryVoltmeter}

The battery voltmeter is calibrated for the gain of the analogue front-end and accuracy of the voltage reference used by the \ac{ADC}.  The battery voltmeter calibration model is described by \Fref{eq:batteryVoltmeter} where $v_c$ is the calibrated voltage measurement obtained from the uncalibrated voltage measurement, $v_u$, given the sensitivity, $s_v$.  The units of $v_c$ and $v_u$ are volts.  $s_v$ is a ratio and therefore has no units.  The calibration parameter $s_v$ can be accessed as a device setting.

\begin{equation}
\label{eq:batteryVoltmeter}
v_c = s_v v_u
\end{equation}

\subsection{Inertial sensors}
\label{sec:inertialSensor}

The inertial sensors are the gyroscope, accelerometer, and high-g accelerometer.  Each inertial sensor is calibrated for axis sensitivity, axis offset, inter-axis misalignment, and package misalignment.  The inertial calibration model is described by \Fref{eq:inertial} where $i_c$ is the calibrated inertial measurement obtained from the uncalibrated inertial measurement, $i_u$, given the misalignment matrix, $M$, the sensitivity diagonal matrix, $s$, and the offset vector, $b$.  The inertial calibration model is expanded as \Fref{eq:inertialExpanded} to express the model as 15 scalar quantities.  The units of $i_c$, $i_u$, and $b$ are degrees per second for the gyroscope, and g for the accelerometer and high-g accelerometer.  $M$ and $s$ are ratios and therefore have no units.  The calibration parameters $M$, $s$, and $b$ for each inertial sensor can be accessed as device settings.

\begin{equation}
\label{eq:inertial}
i_c = M s (i_u - b)
\end{equation}

\begin{equation}
\label{eq:inertialExpanded}
    \begin{bmatrix}
        i_{cx}\\
        i_{cy}\\
        i_{cz}\\
    \end{bmatrix}
    =
    \begin{bmatrix}
        m_{xx} & m_{xy} & m_{xz}\\
        m_{yx} & m_{yy} & m_{yz}\\
        m_{zx} & m_{zy} & m_{zz}\\
    \end{bmatrix}
    \begin{bmatrix}
        s_{x} & 0 & 0\\
        0 & s_{y} & 0\\
        0 & 0 & s_{z}\\
    \end{bmatrix}
    \left(
    \begin{bmatrix}
        i_{ux}\\
        i_{uy}\\
        i_{uz}\\
    \end{bmatrix}
    -
    \begin{bmatrix}
        b_{x}\\
        b_{y}\\
        b_{z}\\
    \end{bmatrix}
    \right)
\end{equation}

\subsection{Magnetometer}
\label{sec:magnetometer}

The magnetometer is calibrated for soft iron and hard-iron characteristics.  Soft iron characteristics are distortions that alter the intensity and direction of the magnetic field as measured by the magnetometer.  Soft iron calibration also accounts for magnetometer axis sensitivity, inter-axis misalignment, and package misalignment.  Hard iron characteristics are unintended magnetic fields generated by the device that offset magnetometer measurements.  Hard iron calibration also accounts for magnetometer axis offset.

The magnetometer calibration model is described by \Fref{eq:magnetometer} where $m_c$ is the calibrated magnetometer measurement obtained from the uncalibrated magnetometer measurement, $m_u$, given the soft iron matrix, $S$, the hard iron vector, $h$.  The magnetometer calibration model is expanded as \Fref{eq:magnetometerExpanded} to express the model as 12 scalar quantities.  The units of $m_c$, $m_u$, and $h$ are \ac{a.u.}.  $S$ is a ratio and therefore has no units.  The calibration parameters $S$, $h$ can be accessed as device settings.

\begin{equation}
\label{eq:magnetometer}
m_c = S m_u - h
\end{equation}

\begin{equation}
\label{eq:magnetometerExpanded}
    \begin{bmatrix}
        m_{cx}\\
        m_{cy}\\
        m_{cz}\\
    \end{bmatrix}
    =
    \begin{bmatrix}
        s_{xx} & s_{xy} & s_{xz}\\
        s_{yx} & s_{yy} & s_{yz}\\
        s_{zx} & s_{zy} & s_{zz}\\
    \end{bmatrix}
    \begin{bmatrix}
        m_{ux}\\
        m_{uy}\\
        m_{uz}\\
    \end{bmatrix}
    -
    \begin{bmatrix}
        h_{x}\\
        h_{y}\\
        h_{z}\\
    \end{bmatrix}
\end{equation}

\subsection{Calibration certificate}

Each device is supplied with a calibration certificate unique to that device.  The calibration certificate details all calibration parameters, the calibration date, the ambient temperature and device temperature during calibration, and any equipment used during the calibration process.  The certificate also includes graphs demonstrating the accuracy of the device over the measurement range.  Calibration certificates are provided as a \ac{PDF} file.  There are three ways to access the calibration certificate for a device:

\begin{enumerate}[nolistsep]
    \item Scan the \ac{QR} code on the back of the device.
    \item Open the \enquote{Calibration Certificate.html} file stored on the \ac{microSD} card.
    \item Enter the device serial number on the calibration certificate \href{https://x-io.co.uk/calibration-certificate/}{web page}.
\end{enumerate}
